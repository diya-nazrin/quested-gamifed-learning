<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>QuestEd | Profile</title>
    <link rel="stylesheet" href="quest-style.css" />

    <style>
        body {
            background: url("bg5.jpg") no-repeat center center fixed;
            background-size: cover;
            min-height: 100vh;

            display: flex;
            justify-content: center;
            align-items: center;

            padding: 30px 14px;
        }

        .profile-wrap {
            width: min(980px, 95vw);
            transform: translateY(-60px);
            position: relative;
            z-index: 5;
        }

        /* =========================
           FLOATING DECORATIONS
           ========================= */
        .float-layer {
            position: fixed;
            inset: 0;
            pointer-events: none;
            z-index: 0;
            overflow: hidden;
        }

        .float {
            position: absolute;
            opacity: 0.75;
            filter: drop-shadow(0 10px 20px rgba(0, 0, 0, 0.15));
        }

        .cloud {
            width: 180px;
            height: 90px;
            background: rgba(255, 255, 255, 0.75);
            border-radius: 999px;
            box-shadow:
                60px 0 0 rgba(255, 255, 255, 0.7),
                120px 10px 0 rgba(255, 255, 255, 0.6);
            animation: cloudMove 24s linear infinite;
        }

        .c1 {
            top: 10%;
            left: -20%;
            transform: scale(1.1);
            animation-duration: 30s;
        }

        .c2 {
            top: 22%;
            left: -35%;
            transform: scale(0.8);
            animation-duration: 38s;
            opacity: 0.6;
        }

        .c3 {
            top: 42%;
            left: -30%;
            transform: scale(1.35);
            animation-duration: 45s;
            opacity: 0.5;
        }

        .sparkle {
            font-size: 22px;
            opacity: 0.65;
            animation: sparkleFloat 4s ease-in-out infinite;
        }

        .s1 {
            top: 20%;
            left: 12%;
            animation-delay: 0s;
        }

        .s2 {
            top: 55%;
            left: 8%;
            animation-delay: 1s;
            font-size: 18px;
        }

        .s3 {
            top: 30%;
            left: 78%;
            animation-delay: 0.6s;
            font-size: 26px;
        }

        .s4 {
            top: 62%;
            left: 90%;
            animation-delay: 1.4s;
            font-size: 20px;
        }

        @keyframes cloudMove {
            from {
                transform: translateX(0) scale(1);
            }

            to {
                transform: translateX(140vw) scale(1);
            }
        }

        @keyframes sparkleFloat {

            0%,
            100% {
                transform: translateY(0) rotate(0deg);
            }

            50% {
                transform: translateY(-16px) rotate(8deg);
            }
        }

        /* =========================
           HEADER + AVATAR
           ========================= */
        .profile-title-row {
            display: flex;
            gap: 14px;
            align-items: center;
            flex-wrap: wrap;
            margin-bottom: 14px;
        }

        .avatar {
            width: 92px;
            height: 92px;
            border-radius: 999px;
            background: rgba(244, 228, 188, 0.9);
            border: 4px solid #3e2712;
            box-shadow: 0 20px 55px rgba(0, 0, 0, 0.25);
            overflow: hidden;
            position: relative;
        }

        .avatar::after {
            content: "";
            position: absolute;
            inset: -6px;
            border-radius: 999px;
            box-shadow: 0 0 22px rgba(241, 196, 15, 0.35);
            pointer-events: none;
        }

        .avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        .profile-title {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        /* shimmer ONLY on h1 */
        .profile-title h1 {
            margin: 0;
            font-size: 64px;

            background: linear-gradient(90deg,
                    #BF953F 0%,
                    #FCF6BA 25%,
                    #FBF5B7 50%,
                    #FCF6BA 75%,
                    #BF953F 100%);
            background-size: 200% auto;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: shimmer 3s linear infinite;

            filter: drop-shadow(0px 4px 4px rgba(0, 0, 0, 0.5));
        }

        .sub {
            opacity: 0.9;
            font-weight: 900;
            color: #3e2712;
        }

        /* =========================
           GRID + CARDS
           ========================= */
        .grid {
            display: grid;
            grid-template-columns: 1.2fr 0.8fr;
            gap: 14px;
        }

        @media (max-width: 880px) {
            .grid {
                grid-template-columns: 1fr;
            }
        }

        .card {
            background: rgba(244, 228, 188, 0.60);
            border: 4px solid #3e2712;
            border-radius: 16px;
            padding: 16px;
            box-shadow: 0 22px 70px rgba(0, 0, 0, 0.25);
            transition: transform 0.25s ease, box-shadow 0.25s ease;
        }

        .card:hover {
            transform: translateY(-6px);
            box-shadow: 0 30px 80px rgba(0, 0, 0, 0.28);
        }

        .section-title {
            margin: 0 0 10px;
            font-size: 22px;
            color: #2c1808;
        }

        .progress-row {
            display: flex;
            justify-content: space-between;
            font-weight: 900;
            opacity: 0.9;
            margin-bottom: 8px;
            gap: 10px;
            flex-wrap: wrap;
        }

        .progress-bar {
            height: 12px;
            width: 100%;
            border-radius: 999px;
            background: rgba(0, 0, 0, 0.16);
            overflow: hidden;
            box-shadow: inset 0 0 0 1px rgba(0, 0, 0, 0.12);
        }

        .progress-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #16a34a, #22c55e);
            transition: width 0.4s ease;
        }

        .quest-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 14px;
        }

        .quest-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
            padding: 10px 12px;
            border-radius: 14px;
            border: 2px solid rgba(62, 39, 18, 0.25);
            background: rgba(255, 255, 255, 0.35);
            font-weight: 900;
        }

        .quest-left {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .chip {
            width: 38px;
            height: 38px;
            border-radius: 12px;
            display: grid;
            place-items: center;
            font-weight: 900;
            border: 2px solid rgba(62, 39, 18, 0.35);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.12);
        }

        .chip.done {
            background: rgba(34, 197, 94, 0.35);
            border-color: rgba(20, 83, 45, 0.5);
        }

        .chip.lock {
            background: rgba(0, 0, 0, 0.08);
            opacity: 0.8;
        }

        .quest-actions {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            justify-content: flex-end;
        }

        .mini-btn {
            padding: 8px 10px;
            border-radius: 12px;
            border: none;
            cursor: pointer;
            font-weight: 900;
            transition: 0.15s;
        }

        .mini-btn:hover {
            transform: translateY(-1px);
        }

        .mini-btn.play {
            background: #8e44ad;
            color: white;
        }

        .mini-btn.info {
            background: #3e2712;
            color: #f4e4bc;
        }

        .mini-btn.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .badge-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 12px;
        }

        .badge {
            border: 2px solid rgba(62, 39, 18, 0.25);
            border-radius: 14px;
            padding: 12px;
            background: rgba(255, 255, 255, 0.35);
            font-weight: 900;
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .badge-icon {
            width: 42px;
            height: 42px;
            border-radius: 14px;
            display: grid;
            place-items: center;
            border: 2px solid rgba(62, 39, 18, 0.35);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.12);
        }

        .badge.done .badge-icon {
            background: rgba(34, 197, 94, 0.35);
            border-color: rgba(20, 83, 45, 0.5);
        }

        .badge.locked {
            opacity: 0.55;
            filter: grayscale(1);
        }

        .btn-row {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 14px;
        }

        .danger {
            background: #e74c3c;
            color: white;
        }

        .safe {
            background: #27ae60;
            color: white;
        }

        .neutral {
            background: #3e2712;
            color: #f4e4bc;
        }

        .big-btn {
            padding: 12px 16px;
            border-radius: 14px;
            border: none;
            cursor: pointer;
            font-weight: 900;
            transition: 0.2s;
        }

        .big-btn:hover {
            transform: translateY(-2px);
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }

        @media (max-width: 520px) {
            .stats {
                grid-template-columns: 1fr;
            }
        }

        .stat {
            border-radius: 14px;
            border: 2px solid rgba(62, 39, 18, 0.25);
            background: rgba(255, 255, 255, 0.35);
            padding: 12px;
            font-weight: 900;
        }

        .stat .num {
            font-size: 26px;
            margin-top: 4px;
        }
    </style>
</head>

<body>
    <!-- Floating layer -->
    <div class="float-layer">
        <div class="float cloud c1"></div>
        <div class="float cloud c2"></div>
        <div class="float cloud c3"></div>

        <div class="float sparkle s1">‚ú®</div>
        <div class="float sparkle s2">‚ú®</div>
        <div class="float sparkle s3">‚ú®</div>
        <div class="float sparkle s4">‚ú®</div>
    </div>

    <div class="profile-wrap">

        <!-- Header -->
        <div class="profile-title-row">
            <div class="avatar">
                <img id="avatarImg" src="avatar.jpg" alt="Avatar">
            </div>

            <div class="profile-title">
                <h1>Profile</h1>
                <div class="sub" id="playerName">Adventurer</div>

                <div style="display:flex; gap:8px; margin-top:6px; flex-wrap:wrap;">
                    <input id="nameInput" placeholder="Set your name..."
                        style="padding:8px 10px; border-radius:12px; border:2px solid rgba(62,39,18,0.35); font-weight:900;" />
                    <button class="mini-btn play" onclick="saveName()">Save</button>
                    <button class="mini-btn info" onclick="location.href='python-level.html'">üó∫Ô∏è Back to Map</button>
                </div>
            </div>
        </div>

        <div class="grid">
            <!-- LEFT -->
            <div class="card">
                <h2 class="section-title">üêç Python Progress</h2>

                <div class="progress-row">
                    <span id="progressText">Progress: 0 / 5</span>
                    <span id="progressPercent">0%</span>
                </div>

                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>

                <div class="quest-list" id="questList"></div>

                <div class="btn-row">
                    <button class="big-btn neutral" onclick="location.href='skillselection.html'">üè† Skill
                        Selection</button>
                    <button class="big-btn safe" onclick="location.href='python-level.html'">üó∫Ô∏è Open Map</button>
                    <button class="mini-btn" style="background:#e74c3c;color:white;" onclick="logout()">üö™
                        Logout</button>

                </div>

                <div class="btn-row">
                    <button class="big-btn danger" onclick="resetPython()">Reset Python Progress</button>
                    <button class="big-btn danger" onclick="resetAll()">Reset ALL Progress</button>
                </div>
            </div>

            <!-- RIGHT -->
            <div class="card">
                <h2 class="section-title">üìä Stats</h2>

                <div class="stats">
                    <div class="stat">Quests Done<div class="num" id="questsDone">0</div>
                    </div>
                    <div class="stat">Total Quests<div class="num">5</div>
                    </div>
                    <div class="stat">Completion<div class="num" id="completionNum">0%</div>
                    </div>
                </div>

                <h2 class="section-title" style="margin-top:16px;">üèÖ Badges</h2>
                <div class="badge-grid" id="badgeGrid"></div>
            </div>
        </div>

    </div>

    <script>
        // ===== completion checks =====
        const qTask = localStorage.getItem("qTask") ? parseInt(localStorage.getItem("qTask")) : 0;
        const q1Done = qTask >= 10;

        const q2Done = localStorage.getItem("q2Complete") === "1";
        const q3Done = localStorage.getItem("q3Complete") === "1";
        const q4Done = localStorage.getItem("q4Complete") === "1";
        const q5Done = localStorage.getItem("q5Complete") === "1";

        const quests = [
            { id: 1, name: "Quest 1: Basics", done: q1Done, info: "q1info.html", game: "quest1-game.html" },
            { id: 2, name: "Quest 2: Data Types", done: q2Done, info: "q2info.html", game: "quest2-game.html" },
            { id: 3, name: "Quest 3: Loops", done: q3Done, info: "q3info.html", game: "quest3-game.html" },
            { id: 4, name: "Quest 4: Functions", done: q4Done, info: "q4info.html", game: "quest4-game.html" },
            { id: 5, name: "Quest 5: Final Trial", done: q5Done, info: "q5info.html", game: "quest5-game.html" },
        ];

        function percent(n, total) {
            return Math.round((n / total) * 100);
        }

        function canPlay(id) {
            if (id === 1) return true;
            return quests[id - 2].done;
        }

        function buildQuestList() {
            const list = document.getElementById("questList");
            list.innerHTML = "";

            quests.forEach(q => {
                const item = document.createElement("div");
                item.className = "quest-item";

                const left = document.createElement("div");
                left.className = "quest-left";

                const chip = document.createElement("div");
                chip.className = "chip " + (q.done ? "done" : "lock");
                chip.textContent = q.done ? "‚úì" : "üîí";

                const title = document.createElement("div");
                title.textContent = q.name;

                left.appendChild(chip);
                left.appendChild(title);

                const actions = document.createElement("div");
                actions.className = "quest-actions";

                const infoBtn = document.createElement("button");
                infoBtn.className = "mini-btn info";
                infoBtn.textContent = "Info";
                infoBtn.onclick = () => location.href = q.info;

                const playBtn = document.createElement("button");
                playBtn.className = "mini-btn play " + (!canPlay(q.id) ? "locked" : "");
                playBtn.textContent = "Play";
                playBtn.onclick = () => {
                    if (!canPlay(q.id)) {
                        alert("üîí Complete the previous quest first!");
                        return;
                    }
                    location.href = q.game;
                };

                actions.appendChild(infoBtn);
                actions.appendChild(playBtn);

                item.appendChild(left);
                item.appendChild(actions);
                list.appendChild(item);
            });
        }

        function buildBadges() {
            const grid = document.getElementById("badgeGrid");
            grid.innerHTML = "";

            const badgeNames = [
                "Basics Badge",
                "Types Badge",
                "Loops Badge",
                "Functions Badge",
                "Master Badge"
            ];

            quests.forEach((q, i) => {
                const b = document.createElement("div");
                b.className = "badge " + (q.done ? "done" : "locked");

                const icon = document.createElement("div");
                icon.className = "badge-icon";
                icon.textContent = q.done ? "üèÜ" : "‚ùî";

                const txt = document.createElement("div");
                txt.innerHTML = `<div>${badgeNames[i]}</div>
                <div style="opacity:0.8; font-weight:800; font-size:0.9rem;">
                    ${q.done ? "Unlocked" : "Locked"}
                </div>`;

                b.appendChild(icon);
                b.appendChild(txt);
                grid.appendChild(b);
            });
        }

        function updateProgress() {
            const done = quests.filter(q => q.done).length;
            const total = quests.length;
            const pct = percent(done, total);

            document.getElementById("progressText").innerText = `Progress: ${done} / ${total}`;
            document.getElementById("progressPercent").innerText = `${pct}%`;
            document.getElementById("progressFill").style.width = pct + "%";

            document.getElementById("questsDone").innerText = done;
            document.getElementById("completionNum").innerText = pct + "%";
        }

        function resetPython() {
            if (!confirm("Reset Python progress? This will clear Quest 1-5 progress.")) return;

            localStorage.removeItem("qTask");
            localStorage.removeItem("q2Complete");
            localStorage.removeItem("q3Complete");
            localStorage.removeItem("q4Complete");
            localStorage.removeItem("q5Complete");

            alert("Python progress reset ‚úÖ");
            location.reload();
        }

        function resetAll() {
            if (!confirm("RESET ALL progress? This clears EVERYTHING in localStorage.")) return;
            localStorage.clear();
            alert("All progress reset ‚úÖ");
            location.reload();
        }

        // ===== Name Save/Load =====
        const savedName = localStorage.getItem("playerName");
        if (savedName) document.getElementById("playerName").innerText = savedName;

        function saveName() {
            const input = document.getElementById("nameInput").value.trim();
            if (!input) return;
            localStorage.setItem("playerName", input);
            document.getElementById("playerName").innerText = input;
            document.getElementById("nameInput").value = "";
        }

        // Avatar fallback
        document.getElementById("avatarImg").onerror = function () {
            this.src = "https://i.imgur.com/7k12EPD.png";
        };
        function logout() {
            if (!confirm("Logout from QuestEd?")) return;

            localStorage.removeItem("isLoggedIn");
            alert("Logged out ‚úÖ");
            location.href = "login.html";
        }

        // init
        buildQuestList();
        buildBadges();
        updateProgress();
    </script>
</body>

</html>